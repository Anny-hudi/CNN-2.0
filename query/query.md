CNN 模型参数设定文档（含训练补充内容）

一、模型概述

本 CNN 模型基于卷积神经网络经典架构设计，适用于图像分类 /
目标检测任务。模型采用 \"卷积层 + 池化层 + 全连接层\"
的经典组合结构，通过多层特征提取与非线性变换实现输入数据的模式识别。网络整体包含
2 个卷积块（每个卷积块由卷积层 + 激活层 + 池化层组成）和 2
个全连接层，最终通过 softmax 输出分类结果。

二、输入输出规格

  ----------------------- ----------------------- ---------------------------
  项目                    参数详情                说明

  输入数据格式            32×32×3                 宽 × 高 × 通道数（RGB
                                                  彩色图像）

  输入数据范围            \[0, 255\]              像素值原始范围

  预处理方式              均值归一化 + 数据增强   减去数据集均值（\[123.68,
                                                  116.779, 103.939\]）

  输出类别数              10                      适用于 10 类分类任务

  输出格式                10 维向量               经 softmax 归一化的概率分布
  ----------------------- ----------------------- ---------------------------

2.1 数据增强参数

  ----------------------- ----------------------- -----------------------
  增强方式                参数设置                作用

  随机水平翻转            概率 0.5                增加左右方向多样性

  随机旋转                范围 0-15°              增强角度鲁棒性

  随机裁剪与缩放          64×64 裁剪后缩放至      提升局部特征识别能力
                          32×32                   

  亮度 / 对比度调整       ±10% 随机变化           增强光照变化适应性
  ----------------------- ----------------------- -----------------------

三、网络结构参数

3.1 卷积块 1（Conv Block 1）

3.1.1 卷积层（CONV1）

  ----------------------- ----------------------- --------------------------
  参数名称                数值                    说明

  过滤器数量              6                       提取 6 种基础特征

  过滤器尺寸              5×5                     局部特征感受野大小

  步长（Stride）          1                       滑动窗口步长

  填充（Padding）         0                       不进行边缘填充

  输入尺寸                32×32×3                 原始图像尺寸

  输出尺寸                28×28×6                 计算公式：(32-5+0×2)/1 + 1
                                                  = 28

  偏置项                  有                      每个过滤器对应 1
                                                  个偏置参数

  参数数量                208                     计算：(5×5×3 + 1)×6 = 208
  ----------------------- ----------------------- --------------------------

3.1.2 批归一化层（BN1）

  ----------------------- ----------------------- --------------------------
  参数名称                数值                    说明

  动量（Momentum）        0.99                    滑动平均系数

  epsilon                 1e-5                    数值稳定性参数

  训练模式                批统计量更新            训练时使用批次均值和方差

  推理模式                移动平均统计量          推理时使用累积统计量
  ----------------------- ----------------------- --------------------------

3.1.3 激活层（ACT1）

  ----------------------------------- -----------------------------------
  参数名称                            详情

  激活函数                            ReLU

  功能                                引入非线性变换，缓解梯度消失问题
  ----------------------------------- -----------------------------------

3.1.4 池化层（POOL1）

  ----------------------- ----------------------- -----------------------
  参数名称                数值                    说明

  池化类型                最大池化（Max Pooling） 保留局部特征最大值

  池化窗口尺寸            2×2                     pooling 区域大小

  步长（Stride）          2                       窗口滑动步长

  输入尺寸                28×28×6                 来自 CONV1 的输出

  输出尺寸                14×14×6                 尺寸减半

  参数数量                0                       无可学习参数
  ----------------------- ----------------------- -----------------------

3.2 卷积块 2（Conv Block 2）

（结构与卷积块 1 类似，包含 CONV2、BN2、ACT2、POOL2 层）

3.3 全连接层（Fully Connected Layers）

（包含 flatten 层、FC1、FC2 和输出层）

四、训练参数设置

4.1 基础训练参数

  ----------------- ---------------------- ----------------- ----------------------
  参数类别          参数名称               数值              说明

  基础参数          批次大小（Batch Size） 64                每次迭代的样本数量

                    迭代次数（Epochs）     50                完整训练集的遍历次数

                    初始学习率（Learning   0.001             初始学习率
                    Rate）                                   

                    学习率衰减             多项式衰减        每轮衰减系数 0.9
  ----------------- ---------------------- ----------------- ----------------------

4.2 优化器配置

  ----------------------- ----------------------- -----------------------
  参数名称                数值                    说明

  优化器类型              Adam                    自适应动量优化器

  动量（Momentum）        0.9                     历史梯度积累因子

  权重衰减（Weight        0.0005                  L2 正则化系数
  Decay）                                         

  β1 参数                 0.9                     一阶矩估计衰减率

  β2 参数                 0.999                   二阶矩估计衰减率
  ----------------------- ----------------------- -----------------------

4.3 正则化策略

  ----------------------- ----------------------- -----------------------
  参数名称                数值 / 配置             说明

  Dropout                 0.5（FC1 与 FC2 之间）  防止过拟合

  L2 正则化               0.0005                  权重衰减系数

  早停策略                耐心值 = 10             连续 10 轮无提升则停止

  监控指标                验证集准确率            早停判断标准
  ----------------------- ----------------------- -----------------------

4.4 交叉验证配置

  ----------------------- ----------------------- ------------------------
  参数名称                配置详情                说明

  验证方法                5 折交叉验证            提升评估稳定性

  数据划分方式            分层抽样                保持类别比例一致

  验证集占比              20%                     总样本中用于验证的比例

  评估指标计算方式        折间平均值              降低随机波动影响
  ----------------------- ----------------------- ------------------------

五、训练监控与日志

5.1 评估指标体系

  ----------------------- ----------------------- -----------------------
  指标类型                具体指标                适用场景

  精确性指标              准确率（Accuracy）      整体分类效果评估

                          精确率（Precision）     正例预测准确性

                          召回率（Recall）        正例识别完整性

                          F1 分数（F1-score）     精确率与召回率平衡

  泛化能力指标            交叉熵损失（Cross       概率分布差异评估
                          Entropy）               

                          AUC-ROC 曲线            不平衡数据分类评估

  效率指标                每秒处理样本数（SPS）   模型推理速度评估
  ----------------------- ----------------------- -----------------------

5.2 日志记录配置

  ----------------------- ------------------------ ------------------------------------
  日志类型                工具 / 方法              记录内容

  可视化日志              TensorBoard              损失曲线、准确率曲线、特征图可视化

  文本日志                Python Logging 库        训练进度、超参数配置、异常信息

  实验追踪                WandB                    实验对比、超参数搜索、模型版本管理

  日志频率                每轮（Epoch）记录一次    训练集 / 验证集损失、准确率、学习率

  日志存储路径            ./logs/YYYYMMDD-HHMMSS   按时间戳分目录存储，便于追溯
  ----------------------- ------------------------ ------------------------------------

5.3 模型保存策略

  ----------------------- ---------------------------- -----------------------------
  保存类型                触发条件                     存储路径格式

  最佳模型保存            验证集准确率刷新历史最高值   ./checkpoints/best_model.h5

  定期保存                每 5 个 Epoch 保存一次       ./checkpoints/epoch\_{n}.h5

  最终模型保存            训练结束后自动保存           ./outputs/final_model.h5

  保存内容                权重参数 + 网络结构 +        支持断点续训
                          优化器状态                   
  ----------------------- ---------------------------- -----------------------------

六、损失函数配置

  ----------------- ------------------- ----------------- --------------------
  任务类型          损失函数            参数设置          适用场景

  分类任务          交叉熵损失（Cross   无额外参数        多类别分类问题
                    Entropy）                             

  回归任务          均方误差（MSE）     无额外参数        连续值预测任务

  目标检测          Smooth L1 Loss      β=1.0             边界框回归任务

                    IoU Loss            无额外参数        提高检测框定位精度
  ----------------- ------------------- ----------------- --------------------

七、模型参数汇总

  -------------- -------------- -------------- -------------- --------------
  层类型         层数           总参数数量     可训练参数     非训练参数

  卷积层         2              2624           2624           0

  池化层         2              0              0              0

  全连接层       3              59134          59134          0

  **总计**       **7**          **61758**      **61758**      **0**
  -------------- -------------- -------------- -------------- --------------

注：训练过程中关键超参数组合建议通过网格搜索或贝叶斯优化进行调优，重点关注学习率、批次大小和正则化系数的组合效果。所有训练参数均需记录完整以便实验复现。Batch
Normalization
层在训练时使用批次统计量，推理时切换为移动平均统计量以保证稳定性。
